<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>开通VIP - <?=SITE()["name"]?></title>
		<meta name="keywords" content="开通VIP,<?=SITE()["keywords"]?>" />
		<meta name="Author" content="<?=SITE()["author"]?>" />
		<meta name="Description" content="开通VIP,<?=SITE()["description"]?>" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
		<meta name="format-detection" content="telephone=no" />
		<link rel="stylesheet" type="text/css" href="/css/reset.css?<?=VERSION()?>">
		<link rel="stylesheet" type="text/css" href="/css/style.css?<?=VERSION()?>">
		<link rel="stylesheet" type="text/css" href="/css/account.css?<?=VERSION()?>">
		<script type="text/javascript" src="/js/lib/jquery.min.js?<?=VERSION()?>"></script>
	</head>
	<body class="bg-gray">
		<?php $this->load->view("layout/header", array("title"=>"开通VIP"))?>
		<div class="title-1">VIP套餐</div>
		<ul data-parent="664528d1-0667-4776-a741-8dc2fe3db232" class="recharge-set">
			<li data-id="vip000002" data-name="1个月VIP" data-symbol="¥" data-unit="RMB" data-amount="12" data-activityid="419a02b2-ee51-486e-a43d-547211433f3a" data-paychannel="adyen" data-timestamp="636942007944917785" data-sign="70899adb6dfce1bb" class="active">
				<div class="recharge-set-info">
					<p class="recharge-set-title">1个月VIP</p>
					<p class="recharge-set-tip">每月¥12</p>
				</div>
				<span class="recharge-set-right">
					<span>¥18</span>¥12
				</span>
			</li>
			<li data-id="vip000003" data-name="3个月VIP" data-symbol="¥" data-unit="RMB" data-amount="32" data-activityid="419a02b2-ee51-486e-a43d-547211433f3a" data-paychannel="adyen" data-timestamp="636942007944917785" data-sign="10123c8ab8d58b9e">
				<div class="recharge-set-info">
					<p class="recharge-set-title">3个月VIP</p>
					<p class="recharge-set-tip">每月¥10.667</p></div>
				<span class="recharge-set-right">
					<span>¥54</span>¥32</span></li>
			<li data-id="vip000004" data-name="6个月VIP" data-symbol="¥" data-unit="RMB" data-amount="55" data-activityid="419a02b2-ee51-486e-a43d-547211433f3a" data-paychannel="adyen" data-timestamp="636942007944917785" data-sign="246aeddd2f1bf1da">
				<div class="recharge-set-info">
					<p class="recharge-set-title">6个月VIP</p>
					<p class="recharge-set-tip">每月¥9.167</p></div>
				<span class="recharge-set-right">
					<span>¥108</span>¥55</span></li>
			<li data-id="vip000005" data-name="12个月VIP" data-symbol="¥" data-unit="RMB" data-amount="99" data-activityid="419a02b2-ee51-486e-a43d-547211433f3a" data-paychannel="adyen" data-timestamp="636942007944917785" data-sign="7e5b5545d916d43c">
				<div class="recharge-set-info">
					<p class="recharge-set-title">12个月VIP</p>
					<p class="recharge-set-tip">送600成长值</p></div>
				<span class="recharge-set-right">
					<span>¥216</span>¥99</span></li>
		</ul>
		<div class="title-1">开通方式</div>
		<ul class="recharge-style">
			<li data-id="664528d1-0667-4776-a741-8dc2fe3db232" data-isnewpage="True" class="active">
				<img class="recharge-style-img" src="http://by218us.cdndm5.com/pay/xinyongka.png">
				<div class="recharge-style-info">
					<p class="recharge-style-title">信用卡</p></div>
				<img class="recharge-style-right" src="http://css122us.cdndm5.com/v201904041843/dm5/images/mobile/recharge-style-right.png"></li>
			<li data-id="8392b456-22f1-4206-8bb4-a86771479796" data-isnewpage="False">
				<img class="recharge-style-img" src="http://by218us.cdndm5.com/pay/paypal.png">
				<div class="recharge-style-info">
					<p class="recharge-style-title">Paypal</p></div>
				<img class="recharge-style-right" src="http://css122us.cdndm5.com/v201904041843/dm5/images/mobile/recharge-style-right.png"></li>
			<li data-id="f19b1aa1-376b-44a4-a7da-13fd1f1942ee" data-isnewpage="False">
				<img class="recharge-style-img" src="http://by218us.cdndm5.com/pay/weixin.png">
				<div class="recharge-style-info">
					<p class="recharge-style-title">微信支付</p></div>
				<img class="recharge-style-right" src="http://css122us.cdndm5.com/v201904041843/dm5/images/mobile/recharge-style-right.png"></li>
			<li data-id="7fbbe690-afce-4a99-9dd1-8a30c2feae3e" data-isnewpage="False">
				<img class="recharge-style-img" src="http://by218us.cdndm5.com/pay/alipay.png">
				<div class="recharge-style-info">
					<p class="recharge-style-title">支付宝</p></div>
				<img class="recharge-style-right" src="http://css122us.cdndm5.com/v201904041843/dm5/images/mobile/recharge-style-right.png"></li>
			<li data-id="4157f269-4a5b-4e41-8c16-a92cad1328d1" data-isnewpage="True">
				<img class="recharge-style-img" src="http://by218us.cdndm5.com/pay/mycard.png">
				<div class="recharge-style-info">
					<p class="recharge-style-title">MyCard</p></div>
				<img class="recharge-style-right" src="http://css122us.cdndm5.com/v201904041843/dm5/images/mobile/recharge-style-right.png"></li>
			<!-- <li>
				<img class="recharge-style-img" src="http://css122us.cdndm5.com/v201904041843/dm5/images/mobile/win-logo.png">
				<div class="recharge-style-info-install">
					<p class="recharge-style-subtitle">更多方式尽在漫画人APP</p></div>
				<a class="recharge-style-right-install">安装</a>
			</li> -->
		</ul>
		<form id="payform" name="payform" action="/payrequest/" method="get" target="_blank">
			<input type="hidden" name="bizName" id="bizName" value="vip" />
			<input type="hidden" name="goodsId" id="goodsId" value="vip000002" />
			<input type="hidden" name="goodsSign" id="goodsSign" value="70899adb6dfce1bb" />
			<input type="hidden" name="goodsName" id="goodsName" value="1个月VIP" />
			<input type="hidden" name="timestamp" id="timestamp" value="636942007944917785" />
			<input type="hidden" name="payChannel" id="payChannel" value="adyen" />
			<input type="hidden" name="amountUnit" id="amountUnit" value="RMB" />
			<input type="hidden" name="activityId" id="activityId" value="419a02b2-ee51-486e-a43d-547211433f3a" />
			<input type="hidden" name="amount" id="amount" value="1.99" />
			<input type="hidden" name="amountSymbol" id="amountSymbol" value="$" />
			<input type="hidden" name="_eventid" id="_eventid" value="" />
			<input type="hidden" name="isNewPage" id="isNewPage" value="true" /></form>
		<div class="recharge-tip">
			<p class="recharge-tip-bottom">
				<a href="/notice/vipopen">《VIP开通协议》 《连续包月协议》</a>
			</p>
		</div>
		<div class="mask" style="display: none;"></div>
		<div id="wxpay" class="win-pay2" style="display: none;">
			<a href="javascript:$('.mask,#wxpay').hide();clearcookie();">
				<img class="win-pay-cross" src="http://css122us.cdndm5.com/v201904041843/dm5/images/mobile/win-cross.png"></a>
			<p class="win-pay-content pb10">请确认微信支付是否已完成？</p>
			<div class="win-pay-btn-group2 pb20">
				<a class="win-pay-btn gary" href="javascript:$('.mask,#wxpay').hide();clearcookie();">未完成</a>
				<a class="win-pay-btn red" href="javascript:void(0);">已完成</a></div>
		</div>
		<div id="payfail" class="win-pay2" style="display: none;">
			<a href="javascript:$('.mask,#payfail').hide();">
				<img class="win-pay-cross" src="http://css122us.cdndm5.com/v201904041843/dm5/images/mobile/win-cross.png"></a>
			<p class="win-pay-content pb10">支付异常
				<br />请稍后在开通记录查看开通情况</p>
			<div class="win-pay-btn-group2 pb20">
				<a class="win-pay-btn gary" href="javascript:$('.mask,#payfail').hide();">我知道了</a></div>
		</div>
		<a class="recharge-fix-btn" href="javascript:void(0);">确认开通</a>
		<script type="text/javascript">$(function() {
				var callback = getCookie('callback');
				var eventid = getCookie('eventid');
				if (callback === '1' && eventid !== '') {
					$('#_eventid').val(eventid);
					$('.mask,#wxpay').show();
				}
				$(".recharge-style li").click(function() {
					if ($(".recharge-style li").index(this) !== $(".recharge-style li").length - 1) {
						$(".recharge-style li").removeClass("active");
						$(this).addClass("active");
						$('#isNewPage').val($(this).data('isnewpage').toLowerCase());
						var $current = $("ul.recharge-set[data-parent=" + $(this).data("id") + "]");
						if ($current) {
							$current.show();
							$("ul.recharge-set").not($current).hide();
							if (!$current.children("li").hasClass("active") && $current.children("li").length > 0) {
								$current.children("li").first().addClass("active");
							}
							if ($current.children("li").hasClass("active")) {
								setvalue($current.children("li.active").first());
							}
						}
					} else {
						window.location.href = 'IOSmanhuaren://';
						setTimeout(function() {
							window.location.href = '/download/';
						},
						2000);
					}
				});
				$("ul.recharge-set li").click(function() {
					$(this).parent().children("li.active").removeClass("active");
					$(this).addClass("active");
					setvalue(this);
				});
				$('#wxpay .win-pay-btn.red').click(function(e) {
					clearcookie();
					$('.mask,#wxpay').hide();
					$.get('/trade.ashx', {
						dt: Date.parse(new Date()),
						_eventid: $('#_eventid').val(),
						action: 'getTradeStatus',
						payChannel: $('#payChannel').val()
					},
					function(content) {
						if (content.response != null && content.response.state == 1) {
							location.href = '/uservip/';
						} else {
							$('.mask,#payfail').show();
						}
					},
					'json');
					e.stopPropagation();
					e.preventDefault();
				});
				$('.recharge-fix-btn').click(function(e) {
					var eventid = "vip" + new Date().getTime();
					var payChannel = $.trim($('#payChannel').val());
					var payform = document.forms[0] || $('#payform')[0];
					if (payform) {
						$('#_eventid').val(eventid);
						if (payChannel === 'wxpay') {
							document.cookie = "callback=1;path=/;";
							document.cookie = "eventid=" + eventid + ";path=/;";
							setTimeout(function() {
								$('.mask,#wxpay').show();
							},
							500);
						}
						if ($('#isNewPage') && $.trim($('#isNewPage').val()).toLowerCase() === 'true') {
							var width = document.body.clientWidth || 400;
							var height = document.body.clientHeight || 735;
							window.open("支付页面", payChannel, "toolbar=no, width=" + width + ", height=" + height + ", directories=no, status=no, scrollorbars=no, resizable=no");
							payform.name = payChannel;
							payform.target = payChannel;
							document.cookie = '_successurl=javascript:window.close();path=/;';
						} else {
							payform.target = '_self';
							var then = new Date();
							then.setTime(then.getTime() - 60000);
							document.cookie = "_successurl=;path=/;expires=" + then.toGMTString();
						}
						payform.submit();
					}
					e.stopPropagation();
					e.preventDefault();
				});
			});
			function setvalue(self) {
				$('#amount').val($(self).data('amount'));
				$('#goodsId').val($(self).data('id'));
				$('#goodsSign').val($(self).data('sign'));
				$('#goodsName').val($(self).data('name'));
				$('#timestamp').val($(self).data('timestamp'));
				$('#payChannel').val($(self).data('paychannel'));
				$('#amountUnit').val($(self).data('unit'));
				$('#activityId').val($(self).data('activityid'));
				$('#amountSymbol').val($(self).data('symbol'));
				if ($(self).data('paychannel') !== 'wxpay') {
					clearcookie();
				}
			}
			function getCookie(cname) {
				var name = cname + "=";
				var ca = document.cookie.split(';');
				for (var i = 0; i < ca.length; i++) {
					var c = ca[i].trim();
					if (c.indexOf(name) == 0) return c.substring(name.length, c.length);
				}
				return "";
			}
			function clearcookie() {
				var then = new Date();
				then.setTime(then.getTime() - 60000);
				document.cookie = "callback=;path=/;expires=" + then.toGMTString();
				document.cookie = "eventid=;path=/;expires=" + then.toGMTString();
			}</script>
		<div style="display:none">
			<script type="text/javascript">(function() {
					var ga = document.createElement('script');
					ga.type = 'text/javascript';
					ga.async = true;
					ga.src = ('https:' == document.location.protocol ? 'https://': 'http://') + "w.cnzz.com/c.php?id=30089965";
					var s = document.getElementsByTagName('script')[0];
					s.parentNode.insertBefore(ga, s);
				})();</script>
			<!--谷歌全站统计-->
			<script type="text/javascript">var _gaq = _gaq || [];
				_gaq.push(['_setAccount', 'UA-495269-1']);
				_gaq.push(['_setDomainName', 'none']);
				_gaq.push(['_setAllowLinker', true]);
				_gaq.push(['_trackPageview']);

				(function() {
					var ga = document.createElement('script');
					ga.type = 'text/javascript';
					ga.async = true;
					ga.src = ('https:' == document.location.protocol ? 'https://ssl': 'http://www') + '.google-analytics.com/ga.js';
					var s = document.getElementsByTagName('script')[0];
					s.parentNode.insertBefore(ga, s);
				})();</script>
			<script type="text/javascript">(function() {
					var ga = document.createElement('script');
					ga.type = 'text/javascript';
					ga.async = true;
					ga.src = ('https:' == document.location.protocol ? 'https://': 'http://') + "w.cnzz.com/c.php?id=1260731659";
					var s = document.getElementsByTagName('script')[0];
					s.parentNode.insertBefore(ga, s);
				})();</script>
		</div>
	</body>

</html>